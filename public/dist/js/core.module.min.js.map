{"version":3,"file":"core.module.min.js","sources":["../../packages/core/generated/scripts/config.js","../../packages/core/api.js","../../packages/core/src/scripts/global/namespace.js","../../packages/core/src/scripts/manipulation/classes.js","../../packages/core/src/scripts/engine/render/renderer.js","../../packages/core/src/scripts/engine/engine.js","../../packages/core/src/scripts/global/initializer.js","../../packages/core/src/scripts/key-listener/key-listener.js","../../packages/core/src/scripts/disclosure/constants.js","../../packages/core/src/scripts/disclosure/disclosures-group.js","../../packages/core/src/scripts/disclosure/disclosure-button.js","../../packages/core/src/scripts/disclosure/disclosure.js","../../packages/core/src/scripts/disclosure/disclosure-types.js","../../packages/core/src/scripts/collapse/collapse-button.js","../../packages/core/src/scripts/collapse/collapses-group.js","../../packages/core/src/scripts/collapse/constants.js","../../packages/core/src/scripts/collapse/collapse.js","../../packages/core/index.js","../../packages/core/src/scripts/manipulation/size.js","../../packages/core/src/scripts/module.js","../../packages/core/src/scripts/collapse/build.js"],"sourcesContent":["export const prefix = 'rf';\r\nexport const namespace = 'dsfr';\r\nexport const organisation = '@gouvfr';\r\n","import { namespace } from './generated/scripts/config.js';\n\nconst api = window[namespace] || {};\nwindow[namespace] = api;\nexport default api;\n","import { prefix } from '../../../generated/scripts/config.js';\n\nexport const ns = (name) => {\n  return `${prefix}-${name}`;\n};\n\nns.selector = (name, notation) => {\n  if (notation === undefined) notation = '.';\n  return `${notation}${ns(name)}`;\n};\n\nns.attr = (name, quoted, value) => {\n  return `data-${ns(name)}`;\n};\n\nns.attr.selector = (name, value) => {\n  let result = ns.attr(name);\n  if (value !== undefined) result += `=\"${value}\"`;\n  return `[${result}]`;\n};\n","const modifiyClass = (element, className, remove) => {\n  if (className.charAt(0) === '.') className = className.substr(1);\n  const classNames = element.className.split(' ');\n  const index = classNames.indexOf(className);\n  if (remove === true) {\n    if (index > -1) classNames.splice(index, 1);\n  } else if (index === -1) classNames.push(className);\n  element.className = classNames.join(' ');\n};\n\nconst addClass = (element, className) => modifiyClass(element, className);\n\nexport { addClass };\n\nconst removeClass = (element, className) => modifiyClass(element, className, true);\n\nexport { removeClass };\n","class Renderer {\n  constructor () {\n    this.closures = [];\n    this.nexts = [];\n    this.rendering = this.render.bind(this);\n    this.render();\n  }\n\n  add (closure) {\n    this.closures.push(closure);\n    const remove = () => {\n      const index = this.closures.indexOf(closure);\n      if (index !== -1) this.closures.splice(index, 1);\n    };\n    return remove;\n  }\n\n  next (closure) {\n    this.nexts.push(closure);\n  }\n\n  render () {\n    window.requestAnimationFrame(this.rendering);\n    for (const closure of this.closures) closure.call();\n    const nexts = this.nexts.slice();\n    this.nexts.length = 0;\n    for (const closure of nexts) closure.call();\n  }\n}\n\nexport { Renderer };\n","import { Renderer } from './render/renderer';\n\n// TODO: initializer et renderer en 1, avec muttation observer pour ajouter et retirer les instances des objets attendus en fonctions de selecteurs spécifiques\nclass Engine {\n  constructor () {\n    this.renderer = new Renderer();\n    // this.instantier = new Instancier();\n  }\n\n  register (selector, factory) {\n\n  }\n\n  start () {\n    // this.renderer.start();\n  }\n\n  stop () {\n    // this.renderer.stop();\n  }\n}\n\nconst engine = new Engine();\n\nexport default engine;\n","class Initializer {\n  constructor (selector, builders) {\n    this.selector = selector;\n    this.builders = builders;\n    this.instances = [];\n\n    if (document.readyState !== 'loading') window.requestAnimationFrame(this.start.bind(this));\n    else document.addEventListener('DOMContentLoaded', this.start.bind(this));\n  }\n\n  start () {\n    if (this.instances.length > 0) return;\n\n    if (document.querySelectorAll(this.selector).length > 0) {\n      for (let i = 0; i < this.builders.length; i++) {\n        this.instances.push(this.builders[i]());\n      }\n    }\n  }\n}\n\nexport { Initializer };\n","/**\n * Utilitaire de gestion des évenements clavier\n * Utiliser KeyListener.add() pour ajouter un event listener\n */\nclass KeyListener {\n  constructor (element) {\n    this.element = element;\n    this.collections = {};\n  }\n\n  /**\n   * key: la touche de clavier\n   * closure: la function à appliquer\n   * type: event type, optionnel, si c'est en down, up ou press\n   * stopPropagation: Boolean, permet d'empêcher le comportement par default de l'evenement\n   */\n  _add (type, action) {\n    if (this.collections[type] === undefined) this.collections[type] = new KeyActionCollection(type, this.element);\n    this.collections[type].add(action);\n  }\n\n  down (key, closure, preventDefault, stopPropagation) {\n    this._add('down', new KeyAction(key, closure, preventDefault, stopPropagation));\n  }\n\n  up (key, closure, preventDefault, stopPropagation) {\n    this._add('up', new KeyAction(key, closure, preventDefault, stopPropagation));\n  }\n\n  dispose () {\n    for (const collection of this.collections) collection.dispose();\n    this.types = null;\n  }\n}\n\nclass KeyActionCollection {\n  constructor (type, element) {\n    this.type = type;\n    this.element = element;\n    this.actions = [];\n    this.binding = this.handle.bind(this);\n    this.element.addEventListener('key' + type, this.binding);\n  }\n\n  add (action) {\n    this.actions.push(action);\n  }\n\n  handle (e) {\n    for (const action of this.actions) action.handle(e);\n  }\n\n  dispose () {\n    this.element.removeEventListener('key' + this.type, this.binding);\n    this.actions = null;\n  }\n}\n\nclass KeyAction {\n  constructor (key, closure, preventDefault, stopPropagation) {\n    this.key = key;\n    this.closure = closure;\n    this.preventDefault = preventDefault === true;\n    this.stopPropagation = stopPropagation === true;\n  }\n\n  handle (e) {\n    if (e.keyCode === this.key) {\n      this.closure(e);\n      if (this.preventDefault) {\n        e.preventDefault();\n      }\n      if (this.stopPropagation) {\n        e.stopPropagation();\n      }\n    }\n  }\n}\n\nKeyListener.TAB = 9;\nKeyListener.ESCAPE = 27;\nKeyListener.END = 35;\nKeyListener.HOME = 36;\nKeyListener.LEFT = 37;\nKeyListener.UP = 38;\nKeyListener.RIGHT = 39;\nKeyListener.DOWN = 40;\n\nexport { KeyListener };\n","import { ns } from '../global/namespace.js';\n\nconst GROUP_ATTR = ns.attr('group');\n\nexport { GROUP_ATTR };\n","import { GROUP_ATTR } from './constants.js';\n\nconst groups = [];\n\nclass DisclosuresGroup {\n  constructor (id, element) {\n    this.id = id;\n    this.element = element;\n    this.members = [];\n    this._index = -1;\n    this._current = null;\n    groups.push(this);\n  }\n\n  static getGroupById (id) {\n    for (const group of groups) if (group.constructor === this && group.id === id) return group;\n    return new this(id);\n  }\n\n  static getGroupByElement (element) {\n    for (const group of groups) if (group.element === element) return group;\n    return new this(false, element);\n  }\n\n  static groupById (member, groupConstructor) {\n    const id = member.element.getAttribute(GROUP_ATTR);\n    if (id === null) return;\n\n    const group = groupConstructor.getGroupById(id);\n    group.add(member);\n  }\n\n  static groupByParent (member, GroupConstructor, groupSelector) {\n    if (groupSelector === undefined) groupSelector = GroupConstructor.selector;\n    if (groupSelector === '') return;\n    let element = member.element.parentElement;\n\n    while (element) {\n      if (element.classList.contains(member.constructor.selector)) return;\n\n      if (element.classList.contains(groupSelector)) {\n        const group = GroupConstructor.getGroupByElement(element);\n        group.add(member);\n        return;\n      }\n      element = element.parentElement;\n    }\n  }\n\n  static get selector () { return ''; }\n\n  add (member) {\n    if (this.members.indexOf(member) !== -1) return;\n    this.members.push(member);\n    member.setGroup(this);\n\n    switch (true) {\n      case this.current !== null:\n      case !member.disclosed:\n        member.apply(false, true);\n        break;\n\n      default:\n        this._current = member;\n        this._index = this.members.indexOf(member);\n        member.apply(true, true);\n    }\n  }\n\n  get length () { return this.members.length; }\n\n  get index () { return this._index; }\n\n  set index (value) {\n    if (value < -1 || value >= this.length || this._index === value) return;\n    if (this.current !== null) this.current.apply(false);\n    this._index = value;\n    this._current = this._index > -1 ? this.members[this._index] : null;\n    if (this.current !== null) this.current.apply(true);\n    this.apply();\n  }\n\n  get current () { return this._current; }\n\n  set current (member) {\n    this.index = this.members.indexOf(member);\n  }\n\n  apply () {}\n}\n\nexport { DisclosuresGroup };\n","class DisclosureButton {\n  constructor (element, disclosure) {\n    this.element = element;\n    this.disclosure = disclosure;\n    this.hasAttribute = this.element.hasAttribute(this.disclosure.attributeName);\n    this.element.addEventListener('click', this.click.bind(this));\n    this.observer = new MutationObserver(this.mutate.bind(this));\n    this.observe();\n  }\n\n  observe () {\n    this.observer.observe(this.element, { attributes: true });\n  }\n\n  click (e) {\n    this.disclosure.change(this.hasAttribute);\n  }\n\n  mutate (mutations) {\n    mutations.forEach((mutation) => {\n      if (mutation.type === 'attributes' && mutation.attributeName === this.disclosure.attributeName) this.disclosure.change(this.disclosed);\n    });\n  }\n\n  apply (value) {\n    if (!this.hasAttribute) return;\n    if (this.observer) this.observer.disconnect();\n    this.element.setAttribute(this.disclosure.attributeName, value);\n    if (this.observer) this.observe();\n  }\n\n  get disclosed () {\n    return this.element.getAttribute(this.disclosure.attributeName) === 'true';\n  }\n}\n\nexport { DisclosureButton };\n","import { DisclosuresGroup } from './disclosures-group.js';\nimport { DisclosureButton } from './disclosure-button.js';\nimport { addClass, removeClass } from '../manipulation/classes.js';\nimport { ns } from '../global/namespace.js';\n\nconst disclosures = [];\n\nclass Disclosure {\n  constructor (element) {\n    this.element = element;\n    this.id = element.id;\n    this.buttons = [];\n    this.disclosed = null;\n    this._selector = this.constructor.selector;\n    this.modifier = this._selector + '--' + this.type.id;\n    this.attributeName = this.type.aria ? 'aria-' + this.type.id : ns.attr(this.type.id);\n\n    const buttons = document.querySelectorAll(this.type.aria ? `[aria-controls=\"${this.id}\"]` : ns.attr.selector('controls', this.id));\n\n    if (buttons.length > 0) for (let i = 0; i < buttons.length; i++) this.addButton(buttons[i]);\n\n    this.disclosed = this.disclosed === true;\n    this.apply(this.disclosed, true);\n\n    this.group();\n  }\n\n  group () {\n    DisclosuresGroup.groupById(this, this.GroupConstructor);\n    DisclosuresGroup.groupByParent(this, this.GroupConstructor);\n  }\n\n  static build (from) {\n    const elements = Array.prototype.slice.call(from.querySelectorAll(`.${this.selector}`));\n\n    for (const element of elements) disclosures.push(new this(element));\n  }\n\n  get type () { return this.constructor.type; }\n\n  static get type () { return null; }\n\n  static get selector () { return ''; }\n\n  addButton (element) {\n    const button = this.buttonFactory(element);\n    if (button.hasAttribute) {\n      if (this.disclosed === null) {\n        this.disclosed = button.disclosed;\n      } else button.apply(this.disclosed);\n    }\n    this.buttons.push(button);\n  }\n\n  get GroupConstructor () { return DisclosuresGroup; }\n\n  buttonFactory (button) {\n    return new DisclosureButton(button, this);\n  }\n\n  disclose () {\n    if (this.disclosed) return;\n\n    if (this.group !== undefined) this.group.current = this;\n    this.apply(true);\n  }\n\n  conceal () {\n    if (!this.disclosed) return;\n\n    if (this.group !== undefined) this.group.current = null;\n    this.apply(false);\n  }\n\n  apply (value, initial) {\n    this.disclosed = value;\n    if (value) addClass(this.element, this.modifier);\n    else removeClass(this.element, this.modifier);\n    for (let i = 0; i < this.buttons.length; i++) this.buttons[i].apply(value);\n    if (!value) for (const disclosure of disclosures) if (disclosure !== this && this.element.contains(disclosure.element)) disclosure.reset();\n  }\n\n  reset () {}\n\n  change (hasAttribute) {\n    if (!this.constructor.type.canConceal) this.disclose();\n    else {\n      switch (true) {\n        case !hasAttribute:\n        case this.disclosed:\n          this.conceal();\n          break;\n\n        default:\n          this.disclose();\n      }\n    }\n  }\n\n  setGroup (group) {\n    this.group = group;\n  }\n\n  get hasFocus () {\n    if (this.element === document.activeElement) return true;\n    if (this.element.querySelectorAll(':focus').length > 0) return true;\n    if (this.buttons.some((button) => { return button.hasFocus; })) return true;\n    return false;\n  }\n\n  focus () {\n    for (let i = 0; i < this.buttons.length; i++) {\n      const button = this.buttons[i];\n      if (button.hasAttribute) {\n        button.element.focus();\n        return;\n      }\n    }\n  }\n}\n\nexport { Disclosure };\n","export const DISCLOSURE_TYPES = {\n  expand: {\n    id: 'expanded',\n    aria: true,\n    canConceal: true\n  },\n  select: {\n    id: 'selected',\n    aria: true,\n    canConceal: false\n  }\n};\n","import { DisclosureButton } from '../disclosure/disclosure-button.js';\n\n/**\n * CollapseButton correspond au bouton cliquable qui change le panel\n * CollapseButton étend de DisclosureButton qui ajoute/enelve l'attribut aria-expanded\n */\nclass CollapseButton extends DisclosureButton {\n  get hasFocus () {\n    return this.element === document.activeElement;\n  }\n}\n\nexport { CollapseButton };\n","import { DisclosuresGroup } from '../disclosure/disclosures-group.js';\n\nconst ascendants = {};\n\nclass CollapsesGroup extends DisclosuresGroup {\n  get hasFocus () {\n    if (this.current === undefined) return null;\n    return this.current.hasFocus;\n  }\n\n  static register (ascendant, groupSelector) {\n    ascendants[ascendant] = groupSelector;\n  }\n\n  static get ascendants () { return ascendants; };\n}\n\nexport { CollapsesGroup };\n","import { ns } from '../global/namespace.js';\n\nconst COLLAPSE_CLASS = ns('collapse');\n\nexport { COLLAPSE_CLASS };\n","import { Disclosure } from '../disclosure/disclosure.js';\nimport { DisclosuresGroup } from '../disclosure/disclosures-group.js';\nimport { CollapseButton } from './collapse-button.js';\nimport { CollapsesGroup } from './collapses-group.js';\nimport { COLLAPSE_CLASS } from './constants.js';\nimport { DISCLOSURE_TYPES } from '../disclosure/disclosure-types.js';\n\n/**\n * Tab coorespond au panel d'un élement Tabs (tab panel)\n * Tab étend disclosure qui ajoute/enleve le modifier --selected,\n * et ajoute/eleve l'attribut hidden, sur le panel\n */\nclass Collapse extends Disclosure {\n  constructor (element) {\n    super(element);\n\n    element.addEventListener('transitionend', this.transitionend.bind(this));\n  }\n\n  group () {\n    for (const ascendant in CollapsesGroup.ascendants) {\n      let element = this.element.parentElement;\n\n      while (element) {\n        if (element.classList.contains(ascendant)) {\n          if (typeof CollapsesGroup.ascendants[ascendant] === 'string') {\n            DisclosuresGroup.groupByParent(this, CollapsesGroup, CollapsesGroup.ascendants[ascendant]);\n          } else {\n            DisclosuresGroup.groupByParent(this, CollapsesGroup.ascendants[ascendant]);\n          }\n          return;\n        }\n\n        element = element.parentElement;\n      }\n    }\n\n    super.group();\n  }\n\n  get GroupConstructor () { return CollapsesGroup; }\n\n  buttonFactory (element) {\n    return new CollapseButton(element, this);\n  }\n\n  static get type () { return DISCLOSURE_TYPES.expand; }\n  static get selector () { return COLLAPSE_CLASS; }\n\n  transitionend (e) {\n    if (!this.disclosed) this.element.style.maxHeight = '';\n  }\n\n  apply (value, initial) {\n    if (value) this.element.style.maxHeight = 'none';\n    this.element.style.setProperty('--collapser', 'none');\n    const height = this.element.offsetHeight;\n    this.element.style.setProperty('--collapse', -height + 'px');\n    this.element.style.setProperty('--collapser', '');\n\n    window.requestAnimationFrame(() => super.apply(value, initial));\n  }\n\n  reset () {\n    this.apply(false);\n  }\n\n  get buttonHasFocus () {\n    if (this.buttons.some((button) => { return button.hasFocus; })) return true;\n    return false;\n  }\n\n  get hasFocus () {\n    if (this.element === document.activeElement) return true;\n    if (this.element.querySelectorAll(':focus').length > 0) return true;\n    return this.buttonHasFocus;\n  }\n}\n\nexport { Collapse };\n","import api from './api.js';\nimport { ns } from './src/scripts/global/namespace.js';\nimport { addClass, removeClass } from './src/scripts/manipulation/classes.js';\nimport engine from './src/scripts/engine/engine.js';\nimport { Initializer } from './src/scripts/global/initializer.js';\nimport { KeyListener } from './src/scripts/key-listener/key-listener.js';\nimport { Disclosure } from './src/scripts/disclosure/disclosure.js';\nimport { DisclosureButton } from './src/scripts/disclosure/disclosure-button.js';\nimport { DisclosuresGroup } from './src/scripts/disclosure/disclosures-group.js';\nimport { DISCLOSURE_TYPES } from './src/scripts/disclosure/disclosure-types.js';\nimport { Collapse } from './src/scripts/collapse/collapse.js';\nimport { CollapseButton } from './src/scripts/collapse/collapse-button.js';\nimport { CollapsesGroup } from './src/scripts/collapse/collapses-group.js';\nimport { Equisized } from './src/scripts/manipulation/size.js';\n\napi.ns = ns;\napi.addClass = addClass;\napi.removeClass = removeClass;\napi.engine = engine;\napi.Initializer = Initializer;\napi.KeyListener = KeyListener;\napi.Disclosure = Disclosure;\napi.DisclosureButton = DisclosureButton;\napi.DisclosuresGroup = DisclosuresGroup;\napi.DISCLOSURE_TYPES = DISCLOSURE_TYPES;\napi.Collapse = Collapse;\napi.CollapseButton = CollapseButton;\napi.CollapsesGroup = CollapsesGroup;\napi.Equisized = Equisized;\n","class EquisizedGroup {\n  constructor (selector, groups) {\n    this.selector = selector;\n    this.groups = typeof groups === 'string' ? document.querySelectorAll(groups) : groups;\n\n    for (let i = 0; i < this.groups.length; i++) {\n      this.equisizedGroups.push(new Equisized(this.selector, this.groups[i]));\n    }\n\n    this.changing = this.change.bind(this);\n    window.addEventListener('resize', this.changing);\n    this.change();\n  }\n\n  change () {\n    for (let i = 0; i < this.equisizedGroups.length; i++) {\n      this.equisizedGroups[i].change();\n    }\n  }\n}\n\nclass Equisized {\n  constructor (selector, group) {\n    this.selector = selector;\n    this.group = group;\n    this.elements = this.group.querySelectorAll(this.selector);\n    this.maxWidth = 0;\n\n    this.changing = this.change.bind(this);\n    window.addEventListener('resize', this.changing);\n    window.addEventListener('load', this.changing); // fix change before css load\n    // this.change();\n  }\n\n  change () {\n    this.reset();\n    for (let i = 0; i < this.elements.length; i++) {\n      const tmpWWidth = this._getWidth(this.elements[i]);\n      if (tmpWWidth > this.maxWidth) {\n        this.maxWidth = tmpWWidth;\n      }\n    }\n    this.apply();\n  }\n\n  apply () {\n    for (let i = 0; i < this.elements.length; i++) {\n      this.elements[i].style.width = this.maxWidth + 1 + 'px';\n    }\n  }\n\n  reset () {\n    for (let i = 0; i < this.elements.length; i++) {\n      this.elements[i].style.width = 'auto';\n    }\n    this.maxWidth = 0;\n  }\n\n  _getWidth (el) {\n    let width = el.offsetWidth;\n    const style = getComputedStyle(el);\n    width += parseInt(style.marginLeft) + parseInt(style.marginRight);\n    return width;\n  }\n}\n\nexport { Equisized, EquisizedGroup };\n","/* eslint-disable no-new */\nimport { Initializer } from './global/initializer.js';\nimport build from './collapse/build.js';\nimport { COLLAPSE_CLASS } from './collapse/constants.js';\n\nnew Initializer(`.${COLLAPSE_CLASS}`, [build]);\n","import { Collapse } from './collapse.js';\n\nconst build = () => {\n  Collapse.build(document);\n};\n\nexport default build;\n"],"names":["api","window","ns","name","selector","notation","undefined","attr","quoted","value","result","modifiyClass","element","className","remove","charAt","substr","classNames","split","index","indexOf","splice","push","join","addClass","removeClass","Renderer","[object Object]","this","closures","nexts","rendering","render","bind","closure","requestAnimationFrame","call","slice","length","engine","renderer","factory","Initializer","builders","instances","document","readyState","start","addEventListener","querySelectorAll","i","KeyListener","collections","type","action","KeyActionCollection","add","key","preventDefault","stopPropagation","_add","KeyAction","collection","dispose","types","actions","binding","handle","e","removeEventListener","keyCode","TAB","ESCAPE","END","HOME","LEFT","UP","RIGHT","DOWN","GROUP_ATTR","groups","DisclosuresGroup","id","members","_index","_current","group","constructor","member","groupConstructor","getAttribute","getGroupById","GroupConstructor","groupSelector","parentElement","classList","contains","getGroupByElement","setGroup","current","disclosed","apply","DisclosureButton","disclosure","hasAttribute","attributeName","click","observer","MutationObserver","mutate","observe","attributes","change","mutations","forEach","mutation","disconnect","setAttribute","disclosures","Disclosure","buttons","_selector","modifier","aria","addButton","groupById","groupByParent","from","elements","Array","prototype","button","buttonFactory","initial","reset","canConceal","conceal","disclose","hasFocus","activeElement","some","focus","DISCLOSURE_TYPES","expand","select","CollapseButton","ascendants","CollapsesGroup","ascendant","COLLAPSE_CLASS","Collapse","super","transitionend","style","maxHeight","setProperty","height","offsetHeight","buttonHasFocus","Equisized","maxWidth","changing","tmpWWidth","_getWidth","width","el","offsetWidth","getComputedStyle","parseInt","marginLeft","marginRight","build"],"mappings":"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"}