/*! DSFR v0.5.5 | licence MIT */
const t=window.dsfr||{};window.dsfr=t;const e=t.ns.selector("modal"),i=t.ns("modal"),n=t.ns("no-scroll"),s=t.ns("scroll-shadow"),l=t.ns.selector("modal__body"),o=['[tabindex="0"]',"a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false" i])',"details>summary:first-of-type","details"].join(),r=['[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'].join(),d=(t,e)=>{if("hidden"===window.getComputedStyle(t).visibility)return!1;for(void 0===e&&(e=t);e.contains(t);){if("none"===window.getComputedStyle(t).display)return!1;t=t.parentElement}return!0};class a{constructor(t,e){this.element=null,this.activeElement=null,this.onTrap=t,this.onUntrap=e,this.waiting=this.wait.bind(this),this.handling=this.handle.bind(this),this.current=null}get trapped(){return null!==this.element}trap(t){this.trapped&&this.untrap(),this.element=t,this.isTrapping=!0,this.wait(),this.onTrap&&this.onTrap()}wait(){d(this.element)?this.trapping():t.engine.renderer.next(this.waiting)}trapping(){if(!this.isTrapping)return;this.isTrapping=!1;const t=this.focusables;t.length&&t[0].focus(),this.element.setAttribute("aria-modal",!0),this.element.addEventListener("keydown",this.handling),this.stunneds=[],this.stun(document.body)}stun(t){for(const e of t.children)e!==this.element&&(e.contains(this.element)?this.stun(e):this.stunneds.push(new h(e)))}handle(t){if(9!==t.keyCode)return;const e=this.focusables;if(0===e.length)return;const i=e[0],n=e[e.length-1],s=e.indexOf(document.activeElement);t.shiftKey?!this.element.contains(document.activeElement)||s<1?(t.preventDefault(),n.focus()):(document.activeElement.tabIndex>0||e[s-1].tabIndex>0)&&(t.preventDefault(),e[s-1].focus()):this.element.contains(document.activeElement)&&s!==e.length-1&&-1!==s?document.activeElement.tabIndex>0&&(t.preventDefault(),e[s+1].focus()):(t.preventDefault(),i.focus())}get focusables(){let t=[...this.element.querySelectorAll(o)];const e=[...this.element.querySelectorAll("fieldset")];let i=[];for(const t of e)i=[...t.querySelectorAll('input[type="radio"]:focus')].length?i.concat([...t.querySelectorAll('input[type="radio"]:not(:focus)')]):[...t.querySelectorAll('input[type="radio"]:checked')].length?i.concat([...t.querySelectorAll('input[type="radio"]:not(:checked)')]):i.concat([...t.querySelectorAll('input[type="radio"]')].splice(0,1));t=t.filter((t=>-1===i.indexOf(t)));const n=[...this.element.querySelectorAll(r)];n.sort(((t,e)=>t.tabIndex-e.tabIndex));const s=t.filter((t=>-1===n.indexOf(t)));return n.concat(s).filter((t=>"-1"!==t.tabIndex&&d(t,this.element)))}untrap(){if(this.trapped){this.isTrapping=!1,this.element.removeAttribute("aria-modal"),this.element.removeEventListener("keydown",this.handling),this.element=null;for(const t of this.stunneds)t.unstun();this.stunneds=[],this.onUntrap&&this.onUntrap()}}}class h{constructor(t){this.element=t,this.hidden=t.getAttribute("aria-hidden"),this.inert=t.getAttribute("inert"),this.element.setAttribute("aria-hidden",!0),this.element.setAttribute("inert","")}unstun(){null===this.hidden?this.element.removeAttribute("aria-hidden"):this.element.setAttribute("aria-hidden",this.hidden),null===this.inert?this.element.removeAttribute("inert"):this.element.setAttribute("inert",this.inert)}}class c extends t.DisclosuresGroup{constructor(){super(),this.trap=new a}apply(t,e){super.apply(t,e),null===this.current?this.trap.untrap():this.trap.trap(this.current.element)}}class u extends t.DisclosureButton{apply(t){super.apply(t)}}const p=new c;class m extends t.Disclosure{constructor(t){super(t),this.body=this.element.querySelector(l),this.scrollDistance=0,this.scrolling=this.resize.bind(this,!1),this.resizing=this.resize.bind(this,!0),this.listen(),this.resize(!0)}listen(){this.element.addEventListener("click",this.click.bind(this)),this.keyListener=new t.KeyListener(this.element),this.keyListener.down(t.KeyListener.ESCAPE,this.conceal.bind(this),!0,!0),this.body&&(this.body.addEventListener("scroll",this.scrolling),window.addEventListener("resize",this.resizing),window.addEventListener("orientationchange",this.resizing))}click(t){this.body&&this.element===t.target&&this.conceal()}group(){p.add(this)}apply(t,e){this.handleScroll(!t),t?e||this.resize(!0):e||this.focus(),super.apply(t,e)}handleScroll(e){e?(t.removeClass(document.documentElement,n),document.body.style.top="",window.scroll(0,this.scrollDistance)):(document.documentElement.classList.contains(n)||(this.scrollDistance=window.scrollY),document.body.style.top=-1*this.scrollDistance+"px",t.addClass(document.documentElement,n))}resize(e,i){this.body&&(this.body.scrollHeight>this.body.clientHeight?this.body.offsetHeight+this.body.scrollTop>=this.body.scrollHeight?t.removeClass(this.body,s):t.addClass(this.body,s):t.removeClass(this.body,s),e&&(this.body.style.maxHeight=window.innerHeight-32+"px",requestAnimationFrame((()=>{this.body.style.maxHeight=window.innerHeight-32+"px"}))))}static get type(){return t.DISCLOSURE_TYPES.expand}static get selector(){return i}buttonFactory(t){return new u(t,this)}get GroupConstructor(){return c}}t.Modal=m,t.ModalButton=u,t.ModalsGroup=c,t.FocusTrap=a;new t.Initializer(e,[()=>{m.build(document)}]);
//# sourceMappingURL=modal.module.min.js.map
