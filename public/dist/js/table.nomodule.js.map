{"version":3,"file":"table.nomodule.js","sources":["../../packages/core/generated/scripts/config.js","../../packages/core/api.js","../../packages/table/src/scripts/table/constants.js","../../packages/table/src/scripts/table/table.js","../../packages/table/index.js","../../packages/table/src/scripts/table/build.js","../../packages/table/src/scripts/module.js"],"sourcesContent":["export const prefix = 'rf';\r\nexport const namespace = 'dsfr';\r\nexport const organisation = '@gouvfr';\r\n","import { namespace } from './generated/scripts/config.js';\n\nconst api = window[namespace] || {};\nwindow[namespace] = api;\nexport default api;\n","import api from '../../../api.js';\n\nconst TABLE_SELECTOR = api.ns.selector('table');\n// const TABLE_CLASS = api.ns('table');\nconst TABLE_SCROLLING_SELECTOR = `${api.ns.selector('table')}:not(${api.ns.selector('table--no-scroll')})`;\nconst LEFT = 'left';\nconst RIGHT = 'right';\nconst SHADOW_CLASS = api.ns('table--shadow');\nconst SHADOW_LEFT_CLASS = api.ns('table--shadow-left');\nconst SHADOW_RIGHT_CLASS = api.ns('table--shadow-right');\nconst WRAPPER_CLASS = api.ns('table__wrapper');\nconst CAPTION_BOTTOM_CLASS = ('table--caption-bottom');\nconst SCROLL_OFFSET = 1; // valeur en px du scroll avant laquelle le shadow s'active ou se desactive\n\nexport { TABLE_SELECTOR, TABLE_SCROLLING_SELECTOR, LEFT, RIGHT, SHADOW_CLASS, SHADOW_LEFT_CLASS, SHADOW_RIGHT_CLASS, WRAPPER_CLASS, CAPTION_BOTTOM_CLASS, SCROLL_OFFSET };\n","import api from '../../../api.js';\nimport {\n  SHADOW_CLASS,\n  SHADOW_LEFT_CLASS,\n  SHADOW_RIGHT_CLASS,\n  WRAPPER_CLASS,\n  LEFT,\n  RIGHT,\n  CAPTION_BOTTOM_CLASS, SCROLL_OFFSET\n} from './constants.js';\n\nclass Table {\n  constructor (table) {\n    this.init(table);\n  }\n\n  init (table) {\n    this.table = table;\n    this.tableElem = this.table.querySelector('table');\n    this.tableContent = this.tableElem.querySelector('tbody');\n    this.isScrollable = this.tableContent.offsetWidth > this.tableElem.offsetWidth;\n    this.caption = this.tableElem.querySelector('caption');\n    this.captionHeight = 0;\n    this.wrap();\n\n    const scrolling = this.change.bind(this);\n    this.tableElem.addEventListener('scroll', scrolling);\n    this.change();\n  }\n\n  change () {\n    const newScroll = this.tableContent.offsetWidth > this.tableElem.offsetWidth;\n    let firstTimeScrollable = this.tableElem.offsetWidth > this.table.offsetWidth;\n    if (newScroll || firstTimeScrollable) {\n      this.scroll();\n      this.handleCaption();\n    } else {\n      if (newScroll !== this.isScrollable) this.delete();\n    }\n    this.isScrollable = newScroll;\n    firstTimeScrollable = false;\n  }\n\n  delete () {\n    api.removeClass(this.table, SHADOW_RIGHT_CLASS);\n    api.removeClass(this.table, SHADOW_LEFT_CLASS);\n    api.removeClass(this.table, SHADOW_CLASS);\n    if (this.caption) {\n      this.tableElem.style.marginTop = '';\n      this.caption.style.top = '';\n      this.tableElem.style.marginBottom = '';\n      this.caption.style.bottom = '';\n    }\n  }\n\n  scroll () {\n    api.addClass(this.table, SHADOW_CLASS);\n    this.setShadowPosition();\n  }\n\n  /* ajoute un wrapper autour du tableau */\n  wrap () {\n    const wrapperHtml = document.createElement('div');\n    wrapperHtml.className = WRAPPER_CLASS;\n    this.table.insertBefore(wrapperHtml, this.tableElem);\n    wrapperHtml.appendChild(this.tableElem);\n    this.tableInnerWrapper = wrapperHtml;\n  }\n\n  /* affiche les blocs shadow en fonction de la position du scroll, en ajoutant la classe visible */\n  setShadowPosition () {\n    const tableScrollLeft = this.getScrollPosition(LEFT);\n    const tableScrollRight = this.getScrollPosition(RIGHT);\n\n    // on inverse en cas de lecture droite - gauche\n    if (document.documentElement.getAttribute('dir') === 'rtl') {\n      this.setShadowVisibility(RIGHT, tableScrollLeft);\n      this.setShadowVisibility(LEFT, tableScrollRight);\n    } else {\n      this.setShadowVisibility(LEFT, tableScrollLeft);\n      this.setShadowVisibility(RIGHT, tableScrollRight);\n    }\n  }\n\n  /* Donne le nombre de pixels scrollés honrizontalement dans un element scrollable */\n  getScrollPosition (side) {\n    let inverter = 1;\n    // on inverse en cas de lecture droite - gauche pour que la valeur de scroll soit toujours positive\n    if (document.documentElement.getAttribute('dir') === 'rtl') {\n      inverter = -1;\n    }\n    switch (side) {\n      case LEFT:\n        return this.tableElem.scrollLeft * inverter;\n      case RIGHT:\n        return this.tableContent.offsetWidth - this.tableElem.offsetWidth - this.tableElem.scrollLeft * inverter;\n      default:\n        return false;\n    }\n  }\n\n  /* positionne la caption en top négatif et ajoute un margin-top au wrapper */\n  handleCaption () {\n    if (this.caption) {\n      const style = getComputedStyle(this.caption);\n      const newHeight = this.caption.offsetHeight + parseInt(style.marginTop) + parseInt(style.marginBottom);\n      this.captionHeight = newHeight;\n      if (this.table.classList.contains(CAPTION_BOTTOM_CLASS)) {\n        this.tableElem.style.marginBottom = this.captionHeight + 'px';\n        this.caption.style.bottom = -this.captionHeight + 'px';\n      } else {\n        this.tableElem.style.marginTop = this.captionHeight + 'px';\n        this.caption.style.top = -this.captionHeight + 'px';\n      }\n    }\n  }\n\n  /* ajoute la classe rf-table--shadow-right ou rf-table--shadow-right sur rf-table\n   en fonction d'une valeur de scroll et du sens (right, left) */\n  setShadowVisibility (side, scrollPosition) {\n    // si on a pas scroll, ou qu'on scroll jusqu'au bout\n    if (scrollPosition <= SCROLL_OFFSET) {\n      if (side === LEFT) api.removeClass(this.table, SHADOW_LEFT_CLASS);\n      else if (side === RIGHT) api.removeClass(this.table, SHADOW_RIGHT_CLASS);\n    } else {\n      if (side === LEFT) api.addClass(this.table, SHADOW_LEFT_CLASS);\n      else if (side === RIGHT) api.addClass(this.table, SHADOW_RIGHT_CLASS);\n    }\n  }\n}\n\nexport { Table };\n","import api from './api.js';\nimport { Table } from './src/scripts/table/table.js';\n\napi.Table = Table;\n","import { TABLE_SCROLLING_SELECTOR } from './constants';\nimport { Table } from './table';\n\nconst tables = [];\n\nconst change = () => {\n  for (let i = 0; i < tables.length; i++) tables[i].change();\n};\n\nconst build = () => {\n  const tableNodes = document.querySelectorAll(TABLE_SCROLLING_SELECTOR);\n  for (let i = 0; i < tableNodes.length; i++) tables.push(new Table(tableNodes[i]));\n\n  window.addEventListener('resize', change);\n  window.addEventListener('orientationchange', change);\n  change();\n};\n\nexport { build };\n","/* eslint-disable no-new */\nimport api from '../../api.js';\nimport { build } from './table/build.js';\nimport { TABLE_SELECTOR } from './table/constants';\n\nnew api.Initializer(TABLE_SELECTOR, [build]);\n"],"names":["const","let"],"mappings":"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"}