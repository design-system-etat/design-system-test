{"version":3,"file":"core.nomodule.min.js","sources":["../../packages/core/generated/scripts/config.js","../../packages/core/api.js","../../packages/core/src/scripts/global/namespace.js","../../packages/core/src/scripts/manipulation/classes.js","../../packages/core/src/scripts/engine/render/renderer.js","../../packages/core/src/scripts/engine/engine.js","../../packages/core/src/scripts/global/initializer.js","../../packages/core/src/scripts/key-listener/key-listener.js","../../packages/core/src/scripts/disclosure/constants.js","../../packages/core/src/scripts/disclosure/disclosures-group.js","../../packages/core/src/scripts/disclosure/disclosure-button.js","../../packages/core/src/scripts/disclosure/disclosure.js","../../packages/core/src/scripts/disclosure/disclosure-types.js","../../packages/core/src/scripts/collapse/collapse-button.js","../../packages/core/src/scripts/collapse/collapses-group.js","../../packages/core/src/scripts/collapse/constants.js","../../packages/core/src/scripts/collapse/collapse.js","../../packages/core/src/scripts/manipulation/size.js","../../packages/core/index.js","../../packages/core/src/scripts/module.js","../../packages/core/src/scripts/collapse/build.js"],"sourcesContent":["export const prefix = 'rf';\r\nexport const namespace = 'dsfr';\r\nexport const organisation = '@gouvfr';\r\n","import { namespace } from './generated/scripts/config.js';\n\nconst api = window[namespace] || {};\nwindow[namespace] = api;\nexport default api;\n","import { prefix } from '../../../generated/scripts/config.js';\n\nexport const ns = (name) => {\n  return `${prefix}-${name}`;\n};\n\nns.selector = (name, notation) => {\n  if (notation === undefined) notation = '.';\n  return `${notation}${ns(name)}`;\n};\n\nns.attr = (name, quoted, value) => {\n  return `data-${ns(name)}`;\n};\n\nns.attr.selector = (name, value) => {\n  let result = ns.attr(name);\n  if (value !== undefined) result += `=\"${value}\"`;\n  return `[${result}]`;\n};\n","const modifiyClass = (element, className, remove) => {\n  if (className.charAt(0) === '.') className = className.substr(1);\n  const classNames = element.className.split(' ');\n  const index = classNames.indexOf(className);\n  if (remove === true) {\n    if (index > -1) classNames.splice(index, 1);\n  } else if (index === -1) classNames.push(className);\n  element.className = classNames.join(' ');\n};\n\nconst addClass = (element, className) => modifiyClass(element, className);\n\nexport { addClass };\n\nconst removeClass = (element, className) => modifiyClass(element, className, true);\n\nexport { removeClass };\n","class Renderer {\n  constructor () {\n    this.closures = [];\n    this.nexts = [];\n    this.rendering = this.render.bind(this);\n    this.render();\n  }\n\n  add (closure) {\n    this.closures.push(closure);\n    const remove = () => {\n      const index = this.closures.indexOf(closure);\n      if (index !== -1) this.closures.splice(index, 1);\n    };\n    return remove;\n  }\n\n  next (closure) {\n    this.nexts.push(closure);\n  }\n\n  render () {\n    window.requestAnimationFrame(this.rendering);\n    for (const closure of this.closures) closure.call();\n    const nexts = this.nexts.slice();\n    this.nexts.length = 0;\n    for (const closure of nexts) closure.call();\n  }\n}\n\nexport { Renderer };\n","import { Renderer } from './render/renderer';\n\n// TODO: initializer et renderer en 1, avec muttation observer pour ajouter et retirer les instances des objets attendus en fonctions de selecteurs spécifiques\nclass Engine {\n  constructor () {\n    this.renderer = new Renderer();\n    // this.instantier = new Instancier();\n  }\n\n  register (selector, factory) {\n\n  }\n\n  start () {\n    // this.renderer.start();\n  }\n\n  stop () {\n    // this.renderer.stop();\n  }\n}\n\nconst engine = new Engine();\n\nexport default engine;\n","class Initializer {\n  constructor (selector, builders) {\n    this.selector = selector;\n    this.builders = builders;\n    this.instances = [];\n\n    if (document.readyState !== 'loading') window.requestAnimationFrame(this.start.bind(this));\n    else document.addEventListener('DOMContentLoaded', this.start.bind(this));\n  }\n\n  start () {\n    if (this.instances.length > 0) return;\n\n    if (document.querySelectorAll(this.selector).length > 0) {\n      for (let i = 0; i < this.builders.length; i++) {\n        this.instances.push(this.builders[i]());\n      }\n    }\n  }\n}\n\nexport { Initializer };\n","/**\n * Utilitaire de gestion des évenements clavier\n * Utiliser KeyListener.add() pour ajouter un event listener\n */\nclass KeyListener {\n  constructor (element) {\n    this.element = element;\n    this.collections = {};\n  }\n\n  /**\n   * key: la touche de clavier\n   * closure: la function à appliquer\n   * type: event type, optionnel, si c'est en down, up ou press\n   * stopPropagation: Boolean, permet d'empêcher le comportement par default de l'evenement\n   */\n  _add (type, action) {\n    if (this.collections[type] === undefined) this.collections[type] = new KeyActionCollection(type, this.element);\n    this.collections[type].add(action);\n  }\n\n  down (key, closure, preventDefault, stopPropagation) {\n    this._add('down', new KeyAction(key, closure, preventDefault, stopPropagation));\n  }\n\n  up (key, closure, preventDefault, stopPropagation) {\n    this._add('up', new KeyAction(key, closure, preventDefault, stopPropagation));\n  }\n\n  dispose () {\n    for (const collection of this.collections) collection.dispose();\n    this.types = null;\n  }\n}\n\nclass KeyActionCollection {\n  constructor (type, element) {\n    this.type = type;\n    this.element = element;\n    this.actions = [];\n    this.binding = this.handle.bind(this);\n    this.element.addEventListener('key' + type, this.binding);\n  }\n\n  add (action) {\n    this.actions.push(action);\n  }\n\n  handle (e) {\n    for (const action of this.actions) action.handle(e);\n  }\n\n  dispose () {\n    this.element.removeEventListener('key' + this.type, this.binding);\n    this.actions = null;\n  }\n}\n\nclass KeyAction {\n  constructor (key, closure, preventDefault, stopPropagation) {\n    this.key = key;\n    this.closure = closure;\n    this.preventDefault = preventDefault === true;\n    this.stopPropagation = stopPropagation === true;\n  }\n\n  handle (e) {\n    if (e.keyCode === this.key) {\n      this.closure(e);\n      if (this.preventDefault) {\n        e.preventDefault();\n      }\n      if (this.stopPropagation) {\n        e.stopPropagation();\n      }\n    }\n  }\n}\n\nKeyListener.TAB = 9;\nKeyListener.ESCAPE = 27;\nKeyListener.END = 35;\nKeyListener.HOME = 36;\nKeyListener.LEFT = 37;\nKeyListener.UP = 38;\nKeyListener.RIGHT = 39;\nKeyListener.DOWN = 40;\n\nexport { KeyListener };\n","import { ns } from '../global/namespace.js';\n\nconst GROUP_ATTR = ns.attr('group');\n\nexport { GROUP_ATTR };\n","import { GROUP_ATTR } from './constants.js';\n\nconst groups = [];\n\nclass DisclosuresGroup {\n  constructor (id, element) {\n    this.id = id;\n    this.element = element;\n    this.members = [];\n    this._index = -1;\n    this._current = null;\n    groups.push(this);\n  }\n\n  static getGroupById (id) {\n    for (const group of groups) if (group.constructor === this && group.id === id) return group;\n    return new this(id);\n  }\n\n  static getGroupByElement (element) {\n    for (const group of groups) if (group.element === element) return group;\n    return new this(false, element);\n  }\n\n  static groupById (member, groupConstructor) {\n    const id = member.element.getAttribute(GROUP_ATTR);\n    if (id === null) return;\n\n    const group = groupConstructor.getGroupById(id);\n    group.add(member);\n  }\n\n  static groupByParent (member, GroupConstructor, groupSelector) {\n    if (groupSelector === undefined) groupSelector = GroupConstructor.selector;\n    if (groupSelector === '') return;\n    let element = member.element.parentElement;\n\n    while (element) {\n      if (element.classList.contains(member.constructor.selector)) return;\n\n      if (element.classList.contains(groupSelector)) {\n        const group = GroupConstructor.getGroupByElement(element);\n        group.add(member);\n        return;\n      }\n      element = element.parentElement;\n    }\n  }\n\n  static get selector () { return ''; }\n\n  add (member) {\n    if (this.members.indexOf(member) !== -1) return;\n    this.members.push(member);\n    member.setGroup(this);\n\n    switch (true) {\n      case this.current !== null:\n      case !member.disclosed:\n        member.apply(false, true);\n        break;\n\n      default:\n        this._current = member;\n        this._index = this.members.indexOf(member);\n        member.apply(true, true);\n    }\n  }\n\n  get length () { return this.members.length; }\n\n  get index () { return this._index; }\n\n  set index (value) {\n    if (value < -1 || value >= this.length || this._index === value) return;\n    if (this.current !== null) this.current.apply(false);\n    this._index = value;\n    this._current = this._index > -1 ? this.members[this._index] : null;\n    if (this.current !== null) this.current.apply(true);\n    this.apply();\n  }\n\n  get current () { return this._current; }\n\n  set current (member) {\n    this.index = this.members.indexOf(member);\n  }\n\n  apply () {}\n}\n\nexport { DisclosuresGroup };\n","class DisclosureButton {\n  constructor (element, disclosure) {\n    this.element = element;\n    this.disclosure = disclosure;\n    this.hasAttribute = this.element.hasAttribute(this.disclosure.attributeName);\n    this.element.addEventListener('click', this.click.bind(this));\n    this.observer = new MutationObserver(this.mutate.bind(this));\n    this.observe();\n  }\n\n  observe () {\n    this.observer.observe(this.element, { attributes: true });\n  }\n\n  click (e) {\n    this.disclosure.change(this.hasAttribute);\n  }\n\n  mutate (mutations) {\n    mutations.forEach((mutation) => {\n      if (mutation.type === 'attributes' && mutation.attributeName === this.disclosure.attributeName) this.disclosure.change(this.disclosed);\n    });\n  }\n\n  apply (value) {\n    if (!this.hasAttribute) return;\n    if (this.observer) this.observer.disconnect();\n    this.element.setAttribute(this.disclosure.attributeName, value);\n    if (this.observer) this.observe();\n  }\n\n  get disclosed () {\n    return this.element.getAttribute(this.disclosure.attributeName) === 'true';\n  }\n}\n\nexport { DisclosureButton };\n","import { DisclosuresGroup } from './disclosures-group.js';\nimport { DisclosureButton } from './disclosure-button.js';\nimport { addClass, removeClass } from '../manipulation/classes.js';\nimport { ns } from '../global/namespace.js';\n\nconst disclosures = [];\n\nclass Disclosure {\n  constructor (element) {\n    this.element = element;\n    this.id = element.id;\n    this.buttons = [];\n    this.disclosed = null;\n    this._selector = this.constructor.selector;\n    this.modifier = this._selector + '--' + this.type.id;\n    this.attributeName = this.type.aria ? 'aria-' + this.type.id : ns.attr(this.type.id);\n\n    const buttons = document.querySelectorAll(this.type.aria ? `[aria-controls=\"${this.id}\"]` : ns.attr.selector('controls', this.id));\n\n    if (buttons.length > 0) for (let i = 0; i < buttons.length; i++) this.addButton(buttons[i]);\n\n    this.disclosed = this.disclosed === true;\n    this.apply(this.disclosed, true);\n\n    this.group();\n  }\n\n  group () {\n    DisclosuresGroup.groupById(this, this.GroupConstructor);\n    DisclosuresGroup.groupByParent(this, this.GroupConstructor);\n  }\n\n  static build (from) {\n    const elements = Array.prototype.slice.call(from.querySelectorAll(`.${this.selector}`));\n\n    for (const element of elements) disclosures.push(new this(element));\n  }\n\n  get type () { return this.constructor.type; }\n\n  static get type () { return null; }\n\n  static get selector () { return ''; }\n\n  addButton (element) {\n    const button = this.buttonFactory(element);\n    if (button.hasAttribute) {\n      if (this.disclosed === null) {\n        this.disclosed = button.disclosed;\n      } else button.apply(this.disclosed);\n    }\n    this.buttons.push(button);\n  }\n\n  get GroupConstructor () { return DisclosuresGroup; }\n\n  buttonFactory (button) {\n    return new DisclosureButton(button, this);\n  }\n\n  disclose () {\n    if (this.disclosed) return;\n\n    if (this.group !== undefined) this.group.current = this;\n    this.apply(true);\n  }\n\n  conceal () {\n    if (!this.disclosed) return;\n\n    if (this.group !== undefined) this.group.current = null;\n    this.apply(false);\n  }\n\n  apply (value, initial) {\n    this.disclosed = value;\n    if (value) addClass(this.element, this.modifier);\n    else removeClass(this.element, this.modifier);\n    for (let i = 0; i < this.buttons.length; i++) this.buttons[i].apply(value);\n    if (!value) for (const disclosure of disclosures) if (disclosure !== this && this.element.contains(disclosure.element)) disclosure.reset();\n  }\n\n  reset () {}\n\n  change (hasAttribute) {\n    if (!this.constructor.type.canConceal) this.disclose();\n    else {\n      switch (true) {\n        case !hasAttribute:\n        case this.disclosed:\n          this.conceal();\n          break;\n\n        default:\n          this.disclose();\n      }\n    }\n  }\n\n  setGroup (group) {\n    this.group = group;\n  }\n\n  get hasFocus () {\n    if (this.element === document.activeElement) return true;\n    if (this.element.querySelectorAll(':focus').length > 0) return true;\n    if (this.buttons.some((button) => { return button.hasFocus; })) return true;\n    return false;\n  }\n\n  focus () {\n    for (let i = 0; i < this.buttons.length; i++) {\n      const button = this.buttons[i];\n      if (button.hasAttribute) {\n        button.element.focus();\n        return;\n      }\n    }\n  }\n}\n\nexport { Disclosure };\n","export const DISCLOSURE_TYPES = {\n  expand: {\n    id: 'expanded',\n    aria: true,\n    canConceal: true\n  },\n  select: {\n    id: 'selected',\n    aria: true,\n    canConceal: false\n  }\n};\n","import { DisclosureButton } from '../disclosure/disclosure-button.js';\n\n/**\n * CollapseButton correspond au bouton cliquable qui change le panel\n * CollapseButton étend de DisclosureButton qui ajoute/enelve l'attribut aria-expanded\n */\nclass CollapseButton extends DisclosureButton {\n  get hasFocus () {\n    return this.element === document.activeElement;\n  }\n}\n\nexport { CollapseButton };\n","import { DisclosuresGroup } from '../disclosure/disclosures-group.js';\n\nconst ascendants = {};\n\nclass CollapsesGroup extends DisclosuresGroup {\n  get hasFocus () {\n    if (this.current === undefined) return null;\n    return this.current.hasFocus;\n  }\n\n  static register (ascendant, groupSelector) {\n    ascendants[ascendant] = groupSelector;\n  }\n\n  static get ascendants () { return ascendants; };\n}\n\nexport { CollapsesGroup };\n","import { ns } from '../global/namespace.js';\n\nconst COLLAPSE_CLASS = ns('collapse');\n\nexport { COLLAPSE_CLASS };\n","import { Disclosure } from '../disclosure/disclosure.js';\nimport { DisclosuresGroup } from '../disclosure/disclosures-group.js';\nimport { CollapseButton } from './collapse-button.js';\nimport { CollapsesGroup } from './collapses-group.js';\nimport { COLLAPSE_CLASS } from './constants.js';\nimport { DISCLOSURE_TYPES } from '../disclosure/disclosure-types.js';\n\n/**\n * Tab coorespond au panel d'un élement Tabs (tab panel)\n * Tab étend disclosure qui ajoute/enleve le modifier --selected,\n * et ajoute/eleve l'attribut hidden, sur le panel\n */\nclass Collapse extends Disclosure {\n  constructor (element) {\n    super(element);\n\n    element.addEventListener('transitionend', this.transitionend.bind(this));\n  }\n\n  group () {\n    for (const ascendant in CollapsesGroup.ascendants) {\n      let element = this.element.parentElement;\n\n      while (element) {\n        if (element.classList.contains(ascendant)) {\n          if (typeof CollapsesGroup.ascendants[ascendant] === 'string') {\n            DisclosuresGroup.groupByParent(this, CollapsesGroup, CollapsesGroup.ascendants[ascendant]);\n          } else {\n            DisclosuresGroup.groupByParent(this, CollapsesGroup.ascendants[ascendant]);\n          }\n          return;\n        }\n\n        element = element.parentElement;\n      }\n    }\n\n    super.group();\n  }\n\n  get GroupConstructor () { return CollapsesGroup; }\n\n  buttonFactory (element) {\n    return new CollapseButton(element, this);\n  }\n\n  static get type () { return DISCLOSURE_TYPES.expand; }\n  static get selector () { return COLLAPSE_CLASS; }\n\n  transitionend (e) {\n    if (!this.disclosed) this.element.style.maxHeight = '';\n  }\n\n  apply (value, initial) {\n    if (value) this.element.style.maxHeight = 'none';\n    this.element.style.setProperty('--collapser', 'none');\n    const height = this.element.offsetHeight;\n    this.element.style.setProperty('--collapse', -height + 'px');\n    this.element.style.setProperty('--collapser', '');\n\n    window.requestAnimationFrame(() => super.apply(value, initial));\n  }\n\n  reset () {\n    this.apply(false);\n  }\n\n  get buttonHasFocus () {\n    if (this.buttons.some((button) => { return button.hasFocus; })) return true;\n    return false;\n  }\n\n  get hasFocus () {\n    if (this.element === document.activeElement) return true;\n    if (this.element.querySelectorAll(':focus').length > 0) return true;\n    return this.buttonHasFocus;\n  }\n}\n\nexport { Collapse };\n","class EquisizedGroup {\n  constructor (selector, groups) {\n    this.selector = selector;\n    this.groups = typeof groups === 'string' ? document.querySelectorAll(groups) : groups;\n\n    for (let i = 0; i < this.groups.length; i++) {\n      this.equisizedGroups.push(new Equisized(this.selector, this.groups[i]));\n    }\n\n    this.changing = this.change.bind(this);\n    window.addEventListener('resize', this.changing);\n    this.change();\n  }\n\n  change () {\n    for (let i = 0; i < this.equisizedGroups.length; i++) {\n      this.equisizedGroups[i].change();\n    }\n  }\n}\n\nclass Equisized {\n  constructor (selector, group) {\n    this.selector = selector;\n    this.group = group;\n    this.elements = this.group.querySelectorAll(this.selector);\n    this.maxWidth = 0;\n\n    this.changing = this.change.bind(this);\n    window.addEventListener('resize', this.changing);\n    window.addEventListener('load', this.changing); // fix change before css load\n    // this.change();\n  }\n\n  change () {\n    this.reset();\n    for (let i = 0; i < this.elements.length; i++) {\n      const tmpWWidth = this._getWidth(this.elements[i]);\n      if (tmpWWidth > this.maxWidth) {\n        this.maxWidth = tmpWWidth;\n      }\n    }\n    this.apply();\n  }\n\n  apply () {\n    for (let i = 0; i < this.elements.length; i++) {\n      this.elements[i].style.width = this.maxWidth + 1 + 'px';\n    }\n  }\n\n  reset () {\n    for (let i = 0; i < this.elements.length; i++) {\n      this.elements[i].style.width = 'auto';\n    }\n    this.maxWidth = 0;\n  }\n\n  _getWidth (el) {\n    let width = el.offsetWidth;\n    const style = getComputedStyle(el);\n    width += parseInt(style.marginLeft) + parseInt(style.marginRight);\n    return width;\n  }\n}\n\nexport { Equisized, EquisizedGroup };\n","import api from './api.js';\nimport { ns } from './src/scripts/global/namespace.js';\nimport { addClass, removeClass } from './src/scripts/manipulation/classes.js';\nimport engine from './src/scripts/engine/engine.js';\nimport { Initializer } from './src/scripts/global/initializer.js';\nimport { KeyListener } from './src/scripts/key-listener/key-listener.js';\nimport { Disclosure } from './src/scripts/disclosure/disclosure.js';\nimport { DisclosureButton } from './src/scripts/disclosure/disclosure-button.js';\nimport { DisclosuresGroup } from './src/scripts/disclosure/disclosures-group.js';\nimport { DISCLOSURE_TYPES } from './src/scripts/disclosure/disclosure-types.js';\nimport { Collapse } from './src/scripts/collapse/collapse.js';\nimport { CollapseButton } from './src/scripts/collapse/collapse-button.js';\nimport { CollapsesGroup } from './src/scripts/collapse/collapses-group.js';\nimport { Equisized } from './src/scripts/manipulation/size.js';\n\napi.ns = ns;\napi.addClass = addClass;\napi.removeClass = removeClass;\napi.engine = engine;\napi.Initializer = Initializer;\napi.KeyListener = KeyListener;\napi.Disclosure = Disclosure;\napi.DisclosureButton = DisclosureButton;\napi.DisclosuresGroup = DisclosuresGroup;\napi.DISCLOSURE_TYPES = DISCLOSURE_TYPES;\napi.Collapse = Collapse;\napi.CollapseButton = CollapseButton;\napi.CollapsesGroup = CollapsesGroup;\napi.Equisized = Equisized;\n","/* eslint-disable no-new */\nimport { Initializer } from './global/initializer.js';\nimport build from './collapse/build.js';\nimport { COLLAPSE_CLASS } from './collapse/constants.js';\n\nnew Initializer(`.${COLLAPSE_CLASS}`, [build]);\n","import { Collapse } from './collapse.js';\n\nconst build = () => {\n  Collapse.build(document);\n};\n\nexport default build;\n"],"names":["const","api","window","ns","name","prefix","selector","notation","undefined","attr","quoted","value","let","result","modifiyClass","element","className","remove","charAt","substr","classNames","split","index","indexOf","splice","push","join","addClass","removeClass","Renderer","this","closures","nexts","rendering","render","bind","add","closure","next","requestAnimationFrame","call","slice","length","Engine","renderer","register","factory","start","stop","engine","Initializer","builders","instances","document","readyState","addEventListener","querySelectorAll","i","KeyListener","collections","_add","type","action","KeyActionCollection","down","key","preventDefault","stopPropagation","KeyAction","up","dispose","types","actions","binding","handle","e","removeEventListener","keyCode","TAB","ESCAPE","END","HOME","LEFT","UP","RIGHT","DOWN","GROUP_ATTR","groups","DisclosuresGroup","id","members","_index","_current","getGroupById","group","constructor","getGroupByElement","groupById","member","groupConstructor","getAttribute","groupByParent","GroupConstructor","groupSelector","parentElement","classList","contains","setGroup","current","disclosed","apply","DisclosureButton","disclosure","hasAttribute","attributeName","click","observer","MutationObserver","mutate","observe","attributes","change","mutations","forEach","mutation","disconnect","setAttribute","disclosures","Disclosure","buttons","_selector","modifier","aria","addButton","build","from","Array","prototype","prototypeAccessors","staticAccessors","button","buttonFactory","disclose","conceal","initial","reset","canConceal","hasFocus","activeElement","some","focus","DISCLOSURE_TYPES","expand","select","CollapseButton","ascendants","CollapsesGroup","ascendant","COLLAPSE_CLASS","Collapse","super","transitionend","style","maxHeight","setProperty","height","offsetHeight","buttonHasFocus","Equisized","elements","maxWidth","changing","tmpWWidth","_getWidth","width","el","offsetWidth","getComputedStyle","parseInt","marginLeft","marginRight"],"mappings":"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"}