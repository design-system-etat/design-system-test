/*! DSFR v0.5.5 | licence MIT */
!function(){"use strict";var t=window.dsfr||{};window.dsfr=t;var e=t.ns.selector("modal"),n=t.ns("modal"),i=t.ns("no-scroll"),o=t.ns("scroll-shadow"),s=t.ns.selector("modal__body"),r=['[tabindex="0"]',"a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false" i])',"details>summary:first-of-type","details"].join(),l=['[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'].join(),c=function(t,e){if("hidden"===window.getComputedStyle(t).visibility)return!1;for(void 0===e&&(e=t);e.contains(t);){if("none"===window.getComputedStyle(t).display)return!1;t=t.parentElement}return!0},a=function(t,e){this.element=null,this.activeElement=null,this.onTrap=t,this.onUntrap=e,this.waiting=this.wait.bind(this),this.handling=this.handle.bind(this),this.current=null},u={trapped:{configurable:!0},focusables:{configurable:!0}};u.trapped.get=function(){return null!==this.element},a.prototype.trap=function(t){this.trapped&&this.untrap(),this.element=t,this.isTrapping=!0,this.wait(),this.onTrap&&this.onTrap()},a.prototype.wait=function(){c(this.element)?this.trapping():t.engine.renderer.next(this.waiting)},a.prototype.trapping=function(){if(this.isTrapping){this.isTrapping=!1;var t=this.focusables;t.length&&t[0].focus(),this.element.setAttribute("aria-modal",!0),this.element.addEventListener("keydown",this.handling),this.stunneds=[],this.stun(document.body)}},a.prototype.stun=function(t){for(var e=0,n=t.children;e<n.length;e+=1){var i=n[e];i!==this.element&&(i.contains(this.element)?this.stun(i):this.stunneds.push(new h(i)))}},a.prototype.handle=function(t){if(9===t.keyCode){var e=this.focusables;if(0!==e.length){var n=e[0],i=e[e.length-1],o=e.indexOf(document.activeElement);t.shiftKey?!this.element.contains(document.activeElement)||o<1?(t.preventDefault(),i.focus()):(document.activeElement.tabIndex>0||e[o-1].tabIndex>0)&&(t.preventDefault(),e[o-1].focus()):this.element.contains(document.activeElement)&&o!==e.length-1&&-1!==o?document.activeElement.tabIndex>0&&(t.preventDefault(),e[o+1].focus()):(t.preventDefault(),n.focus())}}},u.focusables.get=function(){for(var t=this,e=[].concat(this.element.querySelectorAll(r)),n=[].concat(this.element.querySelectorAll("fieldset")),i=[],o=0,s=n;o<s.length;o+=1){var a=s[o];i=[].concat(a.querySelectorAll('input[type="radio"]:focus')).length?i.concat([].concat(a.querySelectorAll('input[type="radio"]:not(:focus)'))):[].concat(a.querySelectorAll('input[type="radio"]:checked')).length?i.concat([].concat(a.querySelectorAll('input[type="radio"]:not(:checked)'))):i.concat([].concat(a.querySelectorAll('input[type="radio"]')).splice(0,1))}e=e.filter((function(t){return-1===i.indexOf(t)}));var u=[].concat(this.element.querySelectorAll(l));u.sort((function(t,e){return t.tabIndex-e.tabIndex}));var h=e.filter((function(t){return-1===u.indexOf(t)}));return u.concat(h).filter((function(e){return"-1"!==e.tabIndex&&c(e,t.element)}))},a.prototype.untrap=function(){if(this.trapped){this.isTrapping=!1,this.element.removeAttribute("aria-modal"),this.element.removeEventListener("keydown",this.handling),this.element=null;for(var t=0,e=this.stunneds;t<e.length;t+=1){e[t].unstun()}this.stunneds=[],this.onUntrap&&this.onUntrap()}},Object.defineProperties(a.prototype,u);var h=function(t){this.element=t,this.hidden=t.getAttribute("aria-hidden"),this.inert=t.getAttribute("inert"),this.element.setAttribute("aria-hidden",!0),this.element.setAttribute("inert","")};h.prototype.unstun=function(){null===this.hidden?this.element.removeAttribute("aria-hidden"):this.element.setAttribute("aria-hidden",this.hidden),null===this.inert?this.element.removeAttribute("inert"):this.element.setAttribute("inert",this.inert)};var d=function(t){function e(){t.call(this),this.trap=new a}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(e,n){t.prototype.apply.call(this,e,n),null===this.current?this.trap.untrap():this.trap.trap(this.current.element)},e}(t.DisclosuresGroup),p=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(e){t.prototype.apply.call(this,e)},e}(t.DisclosureButton),y=new d,f=function(e){function r(t){e.call(this,t),this.body=this.element.querySelector(s),this.scrollDistance=0,this.scrolling=this.resize.bind(this,!1),this.resizing=this.resize.bind(this,!0),this.listen(),this.resize(!0)}e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r;var l={GroupConstructor:{configurable:!0}},c={type:{configurable:!0},selector:{configurable:!0}};return r.prototype.listen=function(){this.element.addEventListener("click",this.click.bind(this)),this.keyListener=new t.KeyListener(this.element),this.keyListener.down(t.KeyListener.ESCAPE,this.conceal.bind(this),!0,!0),this.body&&(this.body.addEventListener("scroll",this.scrolling),window.addEventListener("resize",this.resizing),window.addEventListener("orientationchange",this.resizing))},r.prototype.click=function(t){this.body&&this.element===t.target&&this.conceal()},r.prototype.group=function(){y.add(this)},r.prototype.apply=function(t,n){this.handleScroll(!t),t?n||this.resize(!0):n||this.focus(),e.prototype.apply.call(this,t,n)},r.prototype.handleScroll=function(e){e?(t.removeClass(document.documentElement,i),document.body.style.top="",window.scroll(0,this.scrollDistance)):(document.documentElement.classList.contains(i)||(this.scrollDistance=window.scrollY),document.body.style.top=-1*this.scrollDistance+"px",t.addClass(document.documentElement,i))},r.prototype.resize=function(e,n){var i=this;this.body&&(this.body.scrollHeight>this.body.clientHeight?this.body.offsetHeight+this.body.scrollTop>=this.body.scrollHeight?t.removeClass(this.body,o):t.addClass(this.body,o):t.removeClass(this.body,o),e&&(this.body.style.maxHeight=window.innerHeight-32+"px",requestAnimationFrame((function(){i.body.style.maxHeight=window.innerHeight-32+"px"}))))},c.type.get=function(){return t.DISCLOSURE_TYPES.expand},c.selector.get=function(){return n},r.prototype.buttonFactory=function(t){return new p(t,this)},l.GroupConstructor.get=function(){return d},Object.defineProperties(r.prototype,l),Object.defineProperties(r,c),r}(t.Disclosure);t.Modal=f,t.ModalButton=p,t.ModalsGroup=d,t.FocusTrap=a;new t.Initializer(e,[function(){f.build(document)}])}();
//# sourceMappingURL=modal.nomodule.min.js.map
